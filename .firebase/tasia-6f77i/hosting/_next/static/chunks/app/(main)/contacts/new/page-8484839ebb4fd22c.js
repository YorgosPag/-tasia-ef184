(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7154],{2945:function(e,t,i){Promise.resolve().then(i.bind(i,37069))},37069:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return v}});var s=i(57437),n=i(2265),a=i(16463),l=i(39343),c=i(31014),r=i(69842),o=i(57697),d=i(89506),u=i(86763),h=i(89733),m=i(48185),y=i(93363),p=i(95137),f=i(3274),b=i(59061),j=i(25163),x=i(96902),w=i(18473),D=i(87786);function v(){let e=(0,a.useRouter)(),{toast:t}=(0,u.pm)(),{user:i}=(0,D.a)(),[v,E]=(0,n.useState)(!1),[N,T]=(0,n.useState)(null),C=(0,l.cI)({resolver:(0,c.F)(x.O),defaultValues:{name:"",entityType:"Φυσικό Πρόσωπο",photoUrls:{},identity:{type:"Ταυτότητα",number:"",issuingAuthority:""},emails:[],phones:[],socials:[],addresses:[],job:{role:"",specialty:""},notes:""}}),O=async s=>{var n;E(!0);let a={...s};s.birthDate?a.birthDate=r.EK.fromDate(new Date(s.birthDate)):a.birthDate=null,(null===(n=s.identity)||void 0===n?void 0:n.issueDate)?a.identity.issueDate=r.EK.fromDate(new Date(s.identity.issueDate)):a.identity&&(a.identity.issueDate=null),s.addresses&&(a.addresses=s.addresses);let l=function e(t){for(let i in t)void 0===t[i]?delete t[i]:"object"==typeof t[i]&&null!==t[i]&&(e(t[i]),0===Object.keys(t[i]).length&&delete t[i]);return t}(a);try{let n=await (0,r.ET)((0,r.hJ)(d.db,"contacts"),{...l,createdAt:(0,r.Bt)(),createdBy:null==i?void 0:i.uid});if(await (0,w.a)("CREATE_CONTACT",{entityId:n.id,entityType:"contact",name:s.name}),N){t({title:"Η επαφή αποθηκεύτηκε",description:"Ανέβασμα φωτογραφίας..."});let e="contact-images/".concat(n.id,"/").concat(N.name),i=(0,o.iH)(d.tO,e);await (0,o.KV)(i,N);let s=await (0,o.Jt)(i);await (0,r.r7)(n,{photoUrl:s}),await (0,w.a)("UPDATE_CONTACT",{entityId:n.id,entityType:"contact",changes:{photoUrl:s}})}t({title:"Επιτυχία",description:'Η επαφή "'.concat(s.name,'" δημιουργήθηκε.')}),e.push("/contacts")}catch(e){console.error("Error adding contact: ",e),t({variant:"destructive",title:"Σφάλμα",description:"Δεν ήταν δυνατή η δημιουργία της επαφής: ".concat(e.message)})}finally{E(!1)}};return(0,s.jsx)(y.l0,{...C,children:(0,s.jsxs)("form",{onSubmit:C.handleSubmit(O),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(h.z,{type:"button",variant:"outline",size:"sm",onClick:()=>e.back(),children:[(0,s.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Πίσω στις Επαφές"]}),(0,s.jsxs)(h.z,{type:"submit",disabled:v,children:[v?(0,s.jsx)(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Αποθήκευση Επαφής"]})]}),(0,s.jsxs)(m.Zb,{children:[(0,s.jsxs)(m.Ol,{children:[(0,s.jsx)(m.ll,{children:"Δημιουργία Νέας Επαφής"}),(0,s.jsx)(m.SZ,{children:"Συμπληρώστε τα παρακάτω πεδία για να δημιουργήσετε μια νέα επαφή."})]}),(0,s.jsx)(m.aY,{children:(0,s.jsx)(j.t,{form:C,onFileSelect:T})})]})]})})}}},function(e){e.O(0,[3609,9015,8502,1080,5693,5510,323,2962,6460,7853,5590,8275,2885,275,8198,8254,3343,5377,6503,2971,7023,1744],function(){return e(e.s=2945)}),_N_E=e.O()}]);