(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7695],{73631:function(e,t,r){Promise.resolve().then(r.bind(r,47228))},6649:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},47228:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return N}});var n=r(57437),a=r(2265),s=r(69842),i=r(89506),l=r(86763),d=r(87786),o=r(3274),c=r(48185),u=r(24669),f=r(39343),m=r(31014),x=r(16352),h=r(87138),p=r(47304),j=r(89733),g=r(6649),b=r(79055);function v(e){let{attachments:t,unitsMap:r,onEdit:a}=e;return(0,n.jsxs)(p.iA,{children:[(0,n.jsx)(p.xD,{children:(0,n.jsxs)(p.SC,{children:[(0,n.jsx)(p.ss,{children:"Τύπος"}),(0,n.jsx)(p.ss,{children:"Λεπτομέρειες"}),(0,n.jsx)(p.ss,{children:"Συνδεδεμένο Ακίνητο"}),(0,n.jsx)(p.ss,{children:"Κατάσταση"}),(0,n.jsx)(p.ss,{className:"text-right",children:"Ενέργειες"})]})}),(0,n.jsx)(p.RM,{children:t.map(e=>{let t=e.unitId?r.get(e.unitId):null;return(0,n.jsxs)(p.SC,{className:"group",children:[(0,n.jsx)(p.pj,{className:"font-medium capitalize",children:e.type}),(0,n.jsx)(p.pj,{children:e.details||"N/A"}),(0,n.jsx)(p.pj,{children:t?(0,n.jsxs)(h.default,{href:"/units/".concat(t.id),className:"text-primary hover:underline",children:[t.name," (",t.identifier,")"]}):(0,n.jsx)("span",{className:"text-muted-foreground",children:"N/A"})}),(0,n.jsx)(p.pj,{children:e.isStandalone?(0,n.jsx)(b.C,{variant:"secondary",children:"Ανεξάρτητο"}):e.isBundle?(0,n.jsx)(b.C,{variant:"default",children:"Πακέτο"}):(0,n.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,n.jsx)(p.pj,{className:"text-right",children:(0,n.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,n.jsxs)(j.z,{variant:"ghost",size:"icon",title:"Επεξεργασία",onClick:()=>a(e),children:[(0,n.jsx)(g.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Επεξεργασία"})]})})})]},e.id)})})]})}function N(){let{isEditor:e}=(0,d.a)(),{toast:t}=(0,l.pm)(),[r,h]=(0,a.useState)([]),[p,j]=(0,a.useState)([]),[g,b]=(0,a.useState)(!0),[N,y]=(0,a.useState)(!1),[w,C]=(0,a.useState)(null),[S,R]=(0,a.useState)(!1),k=new Map(p.map(e=>[e.id,e])),A=(0,f.cI)({resolver:(0,m.F)(u.K),defaultValues:{type:"parking",identifier:"",details:"",area:"",price:"",sharePercentage:"",isBundle:!0,isStandalone:!1}});(0,a.useEffect)(()=>{console.log("Loaded project ID:","tasia-6f77i");let e=(0,s.cf)((0,s.IO)((0,s.hJ)(i.db,"attachments")),e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));console.log("Attachments data:",t),h(t),b(!1)},e=>{console.error("Attachments Error:",e.message),t({variant:"destructive",title:"Σφάλμα",description:"Failed to load attachments."}),b(!1)}),r=(0,s.cf)((0,s.IO)((0,s.hJ)(i.db,"units")),e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));console.log("Units data:",t),j(t)},e=>{console.error("Units Error:",e.message)});return()=>{e(),r()}},[t]);let E=async e=>{R(!0);let r=(0,x.Y5)(e);try{w?(await (0,s.r7)((0,s.JU)(i.db,"attachments",w.id),r),t({title:"Επιτυχία",description:"Το παρακολούθημα ενημερώθηκε."})):t({variant:"destructive",title:"Σφάλμα",description:"Δεν είναι δυνατή η δημιουργία αυτόνομου παρακολουθήματος από εδώ."}),y(!1)}catch(e){console.error("Failed to save attachment",e),t({variant:"destructive",title:"Σφάλμα",description:"Η αποθήκευση απέτυχε."})}finally{R(!1)}};return(0,n.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Παρακολουθήματα"}),(0,n.jsxs)(c.Zb,{children:[(0,n.jsx)(c.Ol,{children:(0,n.jsxs)(c.ll,{children:["Λίστα Παρακολουθημάτων (",r.length,")"]})}),(0,n.jsx)(c.aY,{children:g?(0,n.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,n.jsx)(o.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,n.jsx)(v,{attachments:r,unitsMap:k,onEdit:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;C(e),e?A.reset(e):A.reset({type:"parking",identifier:"",details:"",area:"",price:"",sharePercentage:"",isBundle:!0,isStandalone:!1}),y(!0)}})})]}),(0,n.jsx)(u.a,{open:N,onOpenChange:y,form:A,onSubmit:A.handleSubmit(E),isSubmitting:S,editingAttachment:w})]})}},79055:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var n=r(57437);r(2265);var a=r(13027),s=r(49354);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(i({variant:r}),t),...a})}},48185:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return c},eW:function(){return u},ll:function(){return d}});var n=r(57437),a=r(2265),s=r(49354);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},47304:function(e,t,r){"use strict";r.d(t,{RM:function(){return d},SC:function(){return o},iA:function(){return i},pj:function(){return u},ss:function(){return c},xD:function(){return l}});var n=r(57437),a=r(2265),s=r(49354);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",r),...a})})});i.displayName="Table";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",r),...a})});l.displayName="TableHeader";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",r),...a})});d.displayName="TableBody",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})}).displayName="TableFooter";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors hover:bg-muted data-[state=selected]:bg-muted",r),...a})});o.displayName="TableRow";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("th",{ref:t,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});c.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("td",{ref:t,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption"},87786:function(e,t,r){"use strict";r.d(t,{H:function(){return o},a:function(){return c}});var n=r(57437),a=r(2265),s=r(70303),i=r(89506),l=r(31721);let d=(0,a.createContext)({user:void 0,role:null,isLoading:!0,isAdmin:!1,isEditor:!1});function o(e){let{children:t}=e,[r,o]=(0,a.useState)(void 0),[c,u]=(0,a.useState)(null),[f,m]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=(0,s.Aj)(i.I8,async e=>{if(e){o(e);try{let t=await (0,l.zl)(e);u(t)}catch(e){console.error("Error finding or creating user document:",e),u(null)}finally{m(!1)}}else o(null),u(null),m(!1)});return()=>e()},[]),(0,n.jsx)(d.Provider,{value:{user:r,role:c,isLoading:f,isAdmin:"admin"===c,isEditor:"admin"===c||"editor"===c},children:t})}let c=()=>{let e=(0,a.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[3609,9015,8502,1080,5693,5510,323,2962,7853,5590,8275,7138,422,8087,2971,7023,1744],function(){return e(e.s=73631)}),_N_E=e.O()}]);