(()=>{var e={};e.id=6659,e.ids=[6659],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},47438:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>d.a,__next_app__:()=>f,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>o}),r(37361),r(58522),r(35866),r(32029);var s=r(23191),a=r(88716),i=r(37922),d=r.n(i),n=r(95231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let o=["",{children:["(main)",{children:["floors",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,37361)),"/home/user/studio/src/app/(main)/floors/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"/home/user/studio/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,32029)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/user/studio/src/app/(main)/floors/[id]/page.tsx"],u="/(main)/floors/[id]/page",f={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(main)/floors/[id]/page",pathname:"/floors/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},46120:(e,t,r)=>{let s={"1929d9b4a55ccca6fd5c13ec1455093a8c2a1bfa":()=>Promise.resolve().then(r.bind(r,21220)).then(e=>e.clearTasiaDataAction),"650cf0f3f0bd18aeafc63b5f69071e5de8f11976":()=>Promise.resolve().then(r.bind(r,21220)).then(e=>e.generateNextAttachmentIdentifierAction),"7040ad050d67ddd3204a1b169328d1d9b63993a9":()=>Promise.resolve().then(r.bind(r,21220)).then(e=>e.findOrCreateUserAction),"7c1778c43d4bcad59f28beb8c7aeb078136cdc4d":()=>Promise.resolve().then(r.bind(r,21220)).then(e=>e.seedNestorDataAction),"948e70e8c58987240e5319b60bd1d6a596ff2cc9":()=>Promise.resolve().then(r.bind(r,21220)).then(e=>e.clearNestorDataAction),"9569bcfade6c590b3d19ca071936f2c3b6bbf4e0":()=>Promise.resolve().then(r.bind(r,21220)).then(e=>e.generateNextUnitIdentifierAction),bb940dc7dad8d371ecc54c42ecedc64f64a96fbe:()=>Promise.resolve().then(r.bind(r,21220)).then(e=>e.seedTasiaDataAction)};async function a(e,...t){return(await s[e]()).apply(null,t)}e.exports={"1929d9b4a55ccca6fd5c13ec1455093a8c2a1bfa":a.bind(null,"1929d9b4a55ccca6fd5c13ec1455093a8c2a1bfa"),"650cf0f3f0bd18aeafc63b5f69071e5de8f11976":a.bind(null,"650cf0f3f0bd18aeafc63b5f69071e5de8f11976"),"7040ad050d67ddd3204a1b169328d1d9b63993a9":a.bind(null,"7040ad050d67ddd3204a1b169328d1d9b63993a9"),"7c1778c43d4bcad59f28beb8c7aeb078136cdc4d":a.bind(null,"7c1778c43d4bcad59f28beb8c7aeb078136cdc4d"),"948e70e8c58987240e5319b60bd1d6a596ff2cc9":a.bind(null,"948e70e8c58987240e5319b60bd1d6a596ff2cc9"),"9569bcfade6c590b3d19ca071936f2c3b6bbf4e0":a.bind(null,"9569bcfade6c590b3d19ca071936f2c3b6bbf4e0"),bb940dc7dad8d371ecc54c42ecedc64f64a96fbe:a.bind(null,"bb940dc7dad8d371ecc54c42ecedc64f64a96fbe")}},83266:(e,t,r)=>{Promise.resolve().then(r.bind(r,40892))},86333:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(62881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},63685:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(62881).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},40892:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var s=r(10326),a=r(17577),i=r(35047),d=r(76),n=r(90445),l=r(11552),o=r(84097),c=r(77506),u=r(91664),f=r(86333);function p({floor:e,onBack:t}){return s.jsx("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(u.z,{variant:"outline",size:"sm",className:"w-fit",type:"button",onClick:t,children:[s.jsx(f.Z,{className:"mr-2 h-4 w-4"}),"Επιστροφή"]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-xl font-bold",children:["Όροφος: ",e.level]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Περιγραφή: ",e.description||"N/A"]})]})]})})}var x=r(29752);function m({pdfUrl:e}){let[t,r]=(0,a.useState)(null),[i,d]=(0,a.useState)(!1),[n,l]=(0,a.useState)(null),{toast:u}=(0,o.pm)();return i?(0,s.jsxs)("div",{className:"flex h-96 w-full items-center justify-center",children:[s.jsx(c.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"}),s.jsx("p",{className:"ml-2",children:"Φόρτωση κάτοψης..."})]}):n?s.jsx("div",{className:"flex flex-col items-center justify-center h-40 border-2 border-dashed border-destructive/50 rounded-lg p-4",children:s.jsx("p",{className:"text-destructive font-semibold",children:n})}):e&&t?s.jsx("div",{style:{height:"75vh",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"0.5rem",overflow:"hidden"},children:s.jsx("iframe",{src:t,title:"Προβολή Κάτοψης",width:"100%",height:"100%",style:{border:"none"},children:(0,s.jsxs)("p",{children:["Ο browser σας δεν υποστηρίζει την ενσωματωμένη προβολή PDF. Μπορείτε να το κατεβάσετε από",(0,s.jsxs)("a",{href:t,className:"text-primary hover:underline",download:!0,children:[" ","εδώ"]}),"."]})})}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-40 border-2 border-dashed rounded-lg",children:[s.jsx("p",{className:"text-muted-foreground",children:"Δεν έχει ανεβεί κάτοψη για αυτόν τον όροφο."}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Παρακαλώ ανεβάστε ένα αρχείο PDF."})]})}function b({floorPlanUrl:e}){return s.jsx(x.Zb,{className:"p-0",children:s.jsx(x.aY,{className:"p-0",children:s.jsx(m,{pdfUrl:e})})})}var h=r(51641),g=r(49260),j=r(41190),v=r(63685);function y({onFileUpload:e,isUploading:t}){let[r,i]=(0,a.useState)(null);return(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{children:[s.jsx(x.ll,{children:"Ανέβασμα Κάτοψης"}),s.jsx(x.SZ,{children:"Επιλέξτε ένα αρχείο PDF για να ανεβάσετε ως κάτοψη για αυτόν τον όροφο."})]}),s.jsx(x.aY,{children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx(j.I,{id:"pdf-upload",type:"file",accept:"application/pdf",onChange:e=>{e.target.files&&e.target.files.length>0&&i(e.target.files[0])},className:"flex-1"}),(0,s.jsxs)(u.z,{onClick:()=>{r&&e(r)},disabled:!r||t,children:[t?s.jsx(c.Z,{className:"mr-2 h-4 w-4 animate-spin"}):s.jsx(v.Z,{className:"mr-2 h-4 w-4"}),t?"Ανέβασμα...":"Ανέβασμα"]})]})})]})}function N(){let e=(0,i.useParams)(),t=(0,i.useRouter)();e.id;let{toast:r}=(0,o.pm)(),{user:u}=(0,g.a)(),[f,x]=(0,a.useState)(null),[m,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)(!1),P=async e=>{if(!e||!f||!u){r({variant:"destructive",title:"Σφάλμα",description:"Δεν βρέθηκαν οι απαραίτητες πληροφορίες (Όροφος, Χρήστης) για τη μεταφόρτωση."});return}N(!0);let t=(0,l.iH)(n.tO,`floor_plans/${f.id}/${e.name}`);try{await (0,l.KV)(t,e);let s=t.fullPath,a=(0,d.qs)(n.db),i=(0,d.JU)(n.db,"floors",f.id);a.update(i,{floorPlanUrl:s});let o=await (0,d.QT)((0,d.JU)(n.db,"buildings",f.buildingId));if(o.exists()){let e=o.data();if(e.projectId&&e.originalId&&f.originalId){let t=(0,d.JU)(n.db,"projects",e.projectId,"buildings",e.originalId,"floors",f.originalId);(await (0,d.QT)(t)).exists()?a.update(t,{floorPlanUrl:s}):console.warn(`Subcollection floor document not found at: projects/${e.projectId}/buildings/${e.originalId}/floors/${f.originalId}`)}else console.warn(`Could not find all necessary IDs to update subcollection: projectId=${e.projectId}, building.originalId=${e.originalId}, floor.originalId=${f.originalId}`)}await a.commit(),r({title:"Επιτυχία",description:"Η κάτοψη ανέβηκε."}),await (0,h.a)("UPLOAD_FLOORPLAN",{entityId:f.id,entityType:"floorplan",details:`Uploaded ${e.name} for floor ${f.level}`,projectId:o.data()?.projectId})}catch(e){console.error("Upload error:",e),r({variant:"destructive",title:"Σφάλμα",description:`Δεν ήταν δυνατή η μεταφόρτωση: ${e.message}`})}finally{N(!1)}};return m||!f?s.jsx("div",{className:"flex justify-center items-center h-full",children:s.jsx(c.Z,{className:"h-16 w-16 animate-spin text-muted-foreground"})}):(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[s.jsx(p,{floor:f,onBack:()=>t.back()}),s.jsx(y,{onFileUpload:P,isUploading:v}),s.jsx(b,{floorPlanUrl:f.floorPlanUrl})]})}function P(){return s.jsx(N,{})}},29752:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>n,SZ:()=>o,Zb:()=>d,aY:()=>c,eW:()=>u,ll:()=>l});var s=r(10326),a=r(17577),i=r(51223);let d=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));d.displayName="Card";let n=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));n.displayName="CardHeader";let l=a.forwardRef(({className:e,...t},r)=>s.jsx("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let o=a.forwardRef(({className:e,...t},r)=>s.jsx("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));o.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let u=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},37361:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>d,__esModule:()=>i,default:()=>n});var s=r(68570);let a=(0,s.createProxy)(String.raw`/home/user/studio/src/app/(main)/floors/[id]/page.tsx`),{__esModule:i,$$typeof:d}=a;a.default;let n=(0,s.createProxy)(String.raw`/home/user/studio/src/app/(main)/floors/[id]/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9733,2401,7729,3241],()=>r(47438));module.exports=s})();