(()=>{var e={};e.id=3527,e.ids=[3527],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},27090:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>l}),s(15465),s(58522),s(35866),s(32029);var r=s(23191),i=s(88716),n=s(37922),a=s.n(n),o=s(95231),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["(main)",{children:["contacts",{children:["[id]",{children:["edit",{children:["[view]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,15465)),"/home/user/studio/src/app/(main)/contacts/[id]/edit/[view]/page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,58522)),"/home/user/studio/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,32029)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],u=["/home/user/studio/src/app/(main)/contacts/[id]/edit/[view]/page.tsx"],d="/(main)/contacts/[id]/edit/[view]/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/contacts/[id]/edit/[view]/page",pathname:"/contacts/[id]/edit/[view]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},56947:(e,t,s)=>{Promise.resolve().then(s.bind(s,29027))},29027:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var r=s(10326),i=s(17577),n=s(35047),a=s(74723),o=s(74064),c=s(76),l=s(90445),u=s(11552),d=s(84097),p=s(29752),m=s(9969),x=s(77506),h=s(47806),f=s(74436),y=s(51641),v=s(49260),j=s(91664),g=s(86333),b=s(31215);function w({contactName:e,isSubmitting:t,isDirty:s,onBack:i,form:n}){return r.jsx("div",{className:"sticky top-0 bg-background py-4 z-10 border-b mb-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between px-1",children:[r.jsx("div",{className:"flex-1",children:(0,r.jsxs)(j.z,{type:"button",variant:"outline",size:"sm",onClick:i,children:[r.jsx(g.Z,{className:"mr-2 h-4 w-4"}),"Πίσω στις Επαφές"]})}),(0,r.jsxs)("div",{className:"flex-1 text-center",children:[r.jsx(p.ll,{children:"Επεξεργασία Επαφής"}),r.jsx(p.SZ,{children:"Ενημερώστε τα παρακάτω πεδία για να επεξεργαστείτε την επαφή."})]}),r.jsx("div",{className:"flex-1 flex justify-end",children:(0,r.jsxs)(j.z,{type:"submit",form:"contact-form",disabled:t||!s,children:[t?r.jsx(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):r.jsx(b.Z,{className:"mr-2 h-4 w-4"}),"Αποθήκευση Αλλαγών"]})})]})})}function q(){let e=(0,n.useRouter)(),t=(0,n.useParams)(),s=t.id;t.view;let{toast:j}=(0,d.pm)(),{user:g}=(0,v.a)(),[b,q]=(0,i.useState)(!0),[P,_]=(0,i.useState)(!1),[N,D]=(0,i.useState)(null),[S,k]=(0,i.useState)(f.i),[E,T]=(0,i.useState)("");(0,i.useRef)(!1);let Z=(0,a.cI)({resolver:(0,o.F)(f.O),defaultValues:{}});Z.watch("entityType"),(0,i.useRef)();let $=e=>{switch(e){case"Φυσικό Πρόσωπο":default:return"individual";case"Νομικό Πρόσωπο":return"legal";case"Δημ. Υπηρεσία":return"public"}},A=async e=>{_(!0);let t=e.photoUrls||{},r=$(e.entityType);try{if(N){j({title:"Ενημέρωση επαφής",description:"Ανέβασμα νέας φωτογραφίας..."});let e=`contact-images/${r}/${s}/${N.name}`,i=(0,u.iH)(l.tO,e);await (0,u.KV)(i,N);let n=await (0,u.Jt)(i);t[r]=n}let i={...e,photoUrls:t};i.birthDate=e.birthDate?c.EK.fromDate(new Date(e.birthDate)):null,i.identity&&(i.identity.issueDate=e.identity?.issueDate?c.EK.fromDate(new Date(e.identity.issueDate)):null),e.addresses&&(i.addresses=e.addresses);let n=function e(t){for(let s in t)void 0===t[s]?delete t[s]:"object"!=typeof t[s]||null===t[s]||t[s]instanceof Date||t[s]instanceof c.EK||(e(t[s]),0!==Object.keys(t[s]).length||delete t[s]);return t}(i);delete n.id;let a=(0,c.JU)(l.db,"contacts",s);await (0,c.r7)(a,n),T(e.name||""),Z.reset({...e,photoUrls:t},{keepDirty:!1}),D(null),await (0,y.a)("UPDATE_CONTACT",{entityId:s,entityType:"contact",name:e.name,changes:e}),j({title:"Επιτυχία",description:`Οι αλλαγές στην επαφή "${e.name}" αποθηκεύτηκαν.`})}catch(e){console.error("Error updating contact: ",e),j({variant:"destructive",title:"Σφάλμα",description:`Δεν ήταν δυνατή η ενημέρωση της επαφής: ${e.message}`})}finally{_(!1)}};return b?r.jsx("div",{className:"flex h-full w-full items-center justify-center",children:r.jsx(x.Z,{className:"h-16 w-16 animate-spin"})}):r.jsx(m.l0,{...Z,children:(0,r.jsxs)("form",{id:"contact-form",onSubmit:Z.handleSubmit(A),className:"space-y-6",children:[r.jsx(w,{contactName:E,isSubmitting:P,isDirty:Z.formState.isDirty,onBack:()=>e.back(),form:Z}),r.jsx(p.Zb,{children:r.jsx(p.aY,{className:"pt-6",children:r.jsx(h.t,{form:Z,onFileSelect:D,openSections:S,onOpenChange:k})})})]})})}function P(){return r.jsx(i.Suspense,{fallback:r.jsx("div",{className:"flex h-full w-full items-center justify-center",children:r.jsx(x.Z,{className:"h-16 w-16 animate-spin"})}),children:r.jsx(q,{})})}},15465:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>a,__esModule:()=>n,default:()=>o});var r=s(68570);let i=(0,r.createProxy)(String.raw`/home/user/studio/src/app/(main)/contacts/[id]/edit/[view]/page.tsx`),{__esModule:n,$$typeof:a}=i;i.default;let o=(0,r.createProxy)(String.raw`/home/user/studio/src/app/(main)/contacts/[id]/edit/[view]/page.tsx#default`)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9733,2401,7119,2880,8181,180,9902,5504,4610,2996,3786,7453,7729,3241,4034,1971],()=>s(27090));module.exports=r})();